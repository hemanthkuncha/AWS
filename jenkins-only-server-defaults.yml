AWSTemplateFormatVersion: "2010-09-09"
Description: Jenkins-Server practice stack.
Resources:
  tomcatserver:
    Type: 'AWS::EC2::Instance'
    Properties: 
      ImageId: ami-0427090fd1714168b
      InstanceType: t2.micro
      KeyName: laptop
      Tags:
        -
          Key: Name
          Value: Jenkins-Server
      UserData:
        Fn::Base64: !Sub |
          #!/bin/bash
          sudo yum -y update
          sudo wget -O /etc/yum.repos.d/jenkins.repo \
          https://pkg.jenkins.io/redhat-stable/jenkins.repo
          sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key
          sudo yum upgrade
          sudo dnf install java-17-amazon-corretto -y
          sudo yum install jenkins -y
          sudo systemctl enable jenkins
          sudo systemctl start jenkins
          sudo cp /var/lib/jenkins/secrets/initialAdminPassword /home/ec2-user/txt.txt
          sudo chown ec2-user:ec2-user txt.txt
